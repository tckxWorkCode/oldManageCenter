(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ebd7e208"],{"16c4":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("div",{staticClass:"container"},[a("div",{staticClass:"topNav"},[a("el-breadcrumb",{staticClass:"breadNav",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"crumb1"},[t._v("首页")]),a("el-breadcrumb-item",{staticClass:"crumb1"},[t._v("平台管理")]),a("el-breadcrumb-item",{staticClass:"crumb1"},[t._v("策略授权")]),a("el-breadcrumb-item",{staticClass:"crumb2"},[t._v("启动度量")])],1)],1),a("div",{staticClass:"wrap"},[a("div",{staticClass:"search"},[a("el-form",{ref:"formInline",staticClass:"formInline",attrs:{inline:!0,"label-position":"right","label-width":"145px",model:t.formInline,size:"small"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"终端名称/网络地址：",prop:"terminalName"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入终端名称/网络地址",oninput:"value=value.replace(/[%]/g, '')"},model:{value:t.formInline.terminalName,callback:function(e){t.$set(t.formInline,"terminalName",e)},expression:"formInline.terminalName"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==t.advancedSearch,expression:"advancedSearch==true"}],attrs:{label:"日期：",prop:"startDate"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",editable:!1,type:"date",placeholder:"选择开始时间"},model:{value:t.formInline.startDate,callback:function(e){t.$set(t.formInline,"startDate",e)},expression:"formInline.startDate"}}),t._v(" "),a("span",{},[t._v("至")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",editable:!1,type:"date",placeholder:"选择结束时间"},model:{value:t.formInline.endDate,callback:function(e){t.$set(t.formInline,"endDate",e)},expression:"formInline.endDate"}})],1),a("el-form-item",{staticClass:"advancedBtn"},[a("el-button",{staticClass:"resetBtn",attrs:{size:"small"},on:{click:t.resetForm}},[t._v("重置")]),a("el-button",{staticClass:"searchBtn",attrs:{size:"small"},on:{click:t.searchData}},[t._v("查询")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.advancedFlag,expression:"advancedFlag==true"}],staticClass:"gaoji",attrs:{size:"small"},on:{click:t.switchBtn}},[t._v("展开"),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{"font-weight":"bold"}})]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==t.advancedFlag,expression:"advancedFlag==false"}],staticClass:"gaoji",attrs:{size:"small"},on:{click:t.switchBtn}},[t._v("收起"),a("i",{staticClass:"el-icon-arrow-up el-icon--right",staticStyle:{"font-weight":"bold"}})])],1)],1)],1),a("div",{staticClass:"mainContainer"},[a("div",{staticClass:"tableTitle"},[t._v("启动度量列表")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"policyTable",staticStyle:{width:"99.9%","font-size":"14px"},attrs:{data:t.policyData,size:"small","tooltip-effect":"light","element-loading-text":"加载中，请稍后","header-cell-style":{height:"48px","background-color":"#F0F2F5",color:"rgba(0, 0, 0, 0.72)",padding:"0px"},"cell-style":{padding:"0px",color:"rgba(0, 0, 0, 0.9)"},fit:!0},on:{"sort-change":t.sortChange}},[a("template",{slot:"empty"},[a("div",[t._v("暂无数据")])]),a("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"序号",width:"50px"}}),a("el-table-column",{attrs:{prop:"name",label:"终端名称","min-width":"100%","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"ip",label:"网络地址","min-width":"100%"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticStyle:{color:"#1ac492",cursor:"pointer"},on:{click:function(a){return t.openDialog(e.row)}}},[t._v(t._s(e.row.ip))])]}}])}),a("el-table-column",{attrs:{prop:"onlineStatus",label:"终端状态"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.onlineStatus?a("span",[a("span",{staticClass:"aqua"},[t._v("●")]),t._v("在线")]):"0"==e.row.onlineStatus?a("span",[a("span",{staticClass:"lightRed"},[t._v("●")]),t._v("离线")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"bmeasureAuthStatus",label:"启动度量策略状态","min-width":"100%",formatter:t.statusVal}}),a("el-table-column",{attrs:{prop:"installerTime",label:"创建时间","min-width":"100%",sortable:"custom","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"left","min-width":"100%"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.onlineStatus?a("el-button",{staticStyle:{color:"#D9D9D9"},attrs:{type:"text"},on:{click:function(a){return t.configure(e.row)}}},[t._v("配置")]):a("el-button",{staticStyle:{color:"#1ac492"},attrs:{type:"text"},on:{click:function(a){return t.configure(e.row)}}},[t._v("配置")])]}}])})],2),t.pageShow?a("el-pagination",{staticClass:"paging",attrs:{align:"right","current-page":t.currentPage.sync,"page-sizes":[10,20],"page-size":t.pageSize,layout:"total, prev, pager, next, sizes, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1)])]),1==t.showDialog?a("div",{staticClass:"dialogContent"},[a("policy-auth-details",{ref:"details",attrs:{rowMessage:t.rowMessage,policyType:t.policyType},on:{closeDialog:t.closeDialog}})],1):t._e(),1==t.mask?a("div",{staticClass:"mask",on:{click:t.closeDialog}}):t._e(),a("add-policy",{ref:"poplay",on:{addSuccess:t.initData}})],1)},i=[],l=(a("d81d"),a("ac1f"),a("5319"),a("b775")),n=a("ac95"),o=a("b893"),r=a("f471"),c=a("d045"),u={name:"PolicyAuthorization",components:{AddPolicy:r["a"],PolicyAuthDetails:c["a"]},data:function(){return{loading:!1,formInline:{terminalName:"",startDate:"",endDate:""},advancedSearch:!0,advancedFlag:!1,emptytxt:"",policyData:[],policyType:1,orderBy:"installer_time desc",currentPage:1,total:0,pageSize:10,pageShow:!0,autorefresh:"",showDialog:!1,mask:!1,rowMessage:{}}},created:function(){Object(o["b"])(this.searchData)},mounted:function(){this.loadData()},beforeDestroy:function(){document.onkeydown=null},methods:{loadData:function(){var t=this;this.loading=!0,t.policyData=[],Object(l["a"])({url:"/sys/lPolicyAuthList",method:"post",data:{condition:this.formInline.terminalName,firstTime:this.formInline.startDate,lastTime:this.formInline.endDate,system_type:"1",orderBy:this.orderBy,searchPage:this.currentPage,searchSize:this.pageSize}}).then((function(e){var a=e.data;t.loading=!1,a.list&&(a.list.map((function(t,e){t.installerTime=Object(n["a"])(t.installerTime)})),t.policyData=a.list,t.total=a.total),0==a.total?t.emptytxt=!0:t.emptytxt=!1}))},statusVal:function(t){var e=this.$createElement,a="";if(null==t.lpolicyStatus)a="";else if(0==t.lpolicyStatus.bmeasureAuthStatus)a=e("span",{class:"wathet"},["已下发"]);else if(1==t.lpolicyStatus.bmeasureAuthStatus)a=e("span",{class:"green"},["已生效"]);else if(2==t.lpolicyStatus.bmeasureAuthStatus){var s=Object(o["a"])(t.lpolicyStatus.bmeasureAuthRes);a=s?e("span",{class:"red"},["下发失败（",s,"）"]):t.lpolicyStatus.bmeasureAuthRes?e("span",{class:"red"},["下发失败（错误码：",t.lpolicyStatus.bmeasureAuthRes,"）"]):e("span",{class:"red"},["下发失败"])}else if(3==t.lpolicyStatus.bmeasureAuthStatus)a=e("span",{class:"wathet"},["注销中"]);else if(4==t.lpolicyStatus.bmeasureAuthStatus)a=e("span",{class:"green"},["已注销"]);else if(5==t.lpolicyStatus.bmeasureAuthStatus){s=Object(o["a"])(t.lpolicyStatus.bmeasureAuthRes);a=s?e("span",{class:"red"},["注销失败（",s,"）"]):t.lpolicyStatus.bmeasureAuthRes?e("span",{class:"red"},["注销失败（错误码：",t.lpolicyStatus.bmeasureAuthRes,"）"]):e("span",{class:"red"},["注销失败"])}else a=e("span",{class:"grey"},["初始化状态"]);return a},switchBtn:function(){this.advancedSearch=!this.advancedSearch,this.advancedFlag=!this.advancedFlag},searchData:function(){var t=this;this.currentPage=1,this.loadData(),this.pageShow=!1,this.$nextTick((function(){t.pageShow=!0}))},indexMethod:function(t){return 1===this.currentPage?t<9?"0"+(t+1):t+1:t+1+this.pageSize*(this.currentPage-1)},sortChange:function(t,e,a){a=t.prop.replace(/([A-Z])/g,"_$1").toLowerCase();"ascending"==t.order?this.orderBy=a:this.orderBy=a+" desc",this.loadData()},handleSizeChange:function(t){var e=this;this.currentPage=1,this.pageSize=t,this.pageShow=!1,this.$nextTick((function(){e.pageShow=!0})),this.loadData()},handleCurrentChange:function(t){this.currentPage=t,this.loadData()},initData:function(){var t=this,e=0;t.autorefresh=setInterval((function(){e++,t.loadData(),e>4&&clearInterval(t.autorefresh)}),2e3)},configure:function(t){0==t.onlineStatus?this.$message({message:"终端已离线",type:"error",showClose:!0}):this.$refs.poplay.diaOpen(t,this.policyType)},openDialog:function(t){this.showDialog=!0,this.rowMessage=JSON.parse(JSON.stringify(t)),this.mask=!0},closeDialog:function(){this.showDialog=!1,this.mask=!1},resetForm:function(){this.formInline.endDate="",this.formInline=Object.assign({},void 0),this.$refs.formInline.resetFields()},reissue:function(t){},del:function(t){var e=this,a=this;this.$confirm("此操作将永久删除该数据，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["a"])({url:"/sys/disablePolicyAuth",method:"post",data:{node_id:t.node_id,policy_type:1}}).then((function(t){var s=t.data;0==s.status&&(a.initData(),e.$message({showClose:!0,message:"删除成功",type:"success"}))}))})).catch((function(t){}))}},destroyed:function(){clearInterval(this.autorefresh)}},d=u,h=(a("c842"),a("2877")),p=Object(h["a"])(d,s,i,!1,null,"38270e7a",null);e["default"]=p.exports},c842:function(t,e,a){"use strict";a("ff73")},ff73:function(t,e,a){}}]);
//# sourceMappingURL=chunk-ebd7e208.d60ace0d.js.map